<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stay Awake</title>
    <!-- Document Title -->
    <!-- Theme color for browser UI (e.g., address bar on mobile) -->
    <meta name="theme-color" content="#49d49d" />
    <!-- Link to the Web App Manifest for PWA capabilities -->
    <link rel="manifest" href="manifest.json" />
    <!-- Bootstrap CSS for styling and layout -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="index.css" />
    <!-- Favicon link (dynamically changed by JS) -->
    <link
      id="web-icon"
      rel="shortcut icon"
      href="./favicon/favicon_green.ico"
      type="image/x-icon"
    />
  </head>

  <body>
    <!-- Navbar Section -->
    <nav
      id="navbar"
      class="navbar navbar-expand-lg navbar-dark background-enabled py-3"
    >
      <div class="container">
        <!-- Brand Name -->
        <a class="navbar-brand" href="#">
          Stay <span class="highlight-text">Awake</span>
          <!-- Span color changes dynamically -->
        </a>
        <!-- Mobile Nav Toggler -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNavDropdown"
          aria-controls="navbarNavDropdown"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <!-- Navbar Links and Settings Dropdown -->
        <div
          class="collapse navbar-collapse align-items-center justify-content-end"
          id="navbarNavDropdown"
        >
          <ul class="navbar-nav gap-lg-4 gap-2 align-items-center">
            <!-- About Modal Trigger -->
            <li class="nav-item">
              <button
                type="button"
                class="btn btn-link nav-link"
                data-bs-toggle="modal"
                data-bs-target="#aboutModal"
              >
                About
              </button>
            </li>
            <!-- External Links -->
            <li class="nav-item">
              <a
                class="nav-link"
                href="https://pranavarya.in"
                target="_blank"
                rel="noopener noreferrer"
                title="Website"
                ><i class="fa-solid fa-globe"></i
              ></a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="https://x.com/PranavArya37"
                target="_blank"
                rel="noopener noreferrer"
                title="Twitter / X"
                ><i class="fa-brands fa-x-twitter"></i
              ></a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="https://github.com/PranavArya37"
                target="_blank"
                rel="noopener noreferrer"
                title="GitHub"
                ><i class="fa-brands fa-github"></i
              ></a>
            </li>
            <!-- Settings Dropdown -->
            <li class="nav-item dropdown">
              <a
                class="nav-link"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                title="Settings"
                ><i class="fa-solid fa-sliders"></i
              ></a>
              <ul class="dropdown-menu dropdown-menu-end">
                <!-- Clock Format Toggle -->
                <li class="px-3 py-2">
                  <div class="form-check form-switch mx-auto">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="clock-format-switch"
                    />
                    <label
                      class="form-check-label small"
                      for="clock-format-switch"
                      >12-Hour Format</label
                    >
                  </div>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li class="dropdown-header small text-uppercase">Widgets</li>
                <!-- Widget Visibility Toggles -->
                <li class="px-3 py-1">
                  <div class="form-check form-switch mx-auto">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="show-clock-widget-switch"
                    />
                    <label
                      class="form-check-label small"
                      for="show-clock-widget-switch"
                      >Show Clock</label
                    >
                  </div>
                </li>
                <li class="px-3 py-1">
                  <div class="form-check form-switch mx-auto">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="show-pomodoro-widget-switch"
                    />
                    <label
                      class="form-check-label small"
                      for="show-pomodoro-widget-switch"
                      >Show Pomodoro</label
                    >
                  </div>
                </li>
                <li class="px-3 py-1">
                  <div class="form-check form-switch mx-auto">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="show-battery-widget-switch"
                    />
                    <label
                      class="form-check-label small"
                      for="show-battery-widget-switch"
                      >Show Battery</label
                    >
                  </div>
                </li>
                <li class="px-3 py-1">
                  <div class="form-check form-switch mx-auto">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="show-todo-widget-switch"
                    />
                    <label
                      class="form-check-label small"
                      for="show-todo-widget-switch"
                      >Show To-Do List</label
                    >
                  </div>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <!-- Minimal Mode Toggle -->
                <li class="px-3 py-2">
                  <div class="form-check form-switch mx-auto">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="minimal-mode-switch"
                    />
                    <label
                      class="form-check-label small"
                      for="minimal-mode-switch"
                      >Minimal Mode</label
                    >
                  </div>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <!-- Actions -->
                <li class="px-3 py-1">
                  <button
                    type="button"
                    id="copy-link-btn"
                    class="dropdown-item small"
                    data-bs-toggle="tooltip"
                    data-bs-placement="left"
                    data-bs-trigger="manual"
                    title="Copied!"
                  >
                    <!-- Tooltip for copy feedback -->
                    <i class="fas fa-copy me-2"></i>Copy Link
                  </button>
                </li>
                <li class="px-3 py-1">
                  <button
                    type="button"
                    id="share-btn"
                    class="dropdown-item small"
                  >
                    <i class="fas fa-share-alt me-2"></i>Share App
                  </button>
                </li>
                <!-- Install PWA Button (hidden by default, shown by JS if install possible) -->
                <li
                  id="install-pwa-item"
                  class="px-3 py-1"
                  style="display: none"
                >
                  <button
                    type="button"
                    id="install-pwa-btn"
                    class="dropdown-item small"
                  >
                    <i class="fas fa-download me-2"></i>Install App
                  </button>
                </li>
                <!-- Help/Troubleshooting Modal Trigger -->
                <li class="px-3 py-1">
                  <button
                    type="button"
                    class="dropdown-item small"
                    data-bs-toggle="modal"
                    data-bs-target="#helpModal"
                  >
                    <i class="fas fa-question-circle me-2"></i>Help /
                    Troubleshooting
                  </button>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- End Navbar Section -->

    <!-- Hero Section (Main Content Area) -->
    <div
      id="hero-section"
      class="info-hero container-fluid background-enabled text-center"
    >
      <div class="container">
        <div class="info-box container-md mx-auto">
          <!-- Greeting message (updated by JS) -->
          <h2 id="user-greeting" class="mb-3"></h2>
          <!-- Main clock display (updated by JS) -->
          <p id="digital-clock" class="mb-4"></p>
          <!-- Static text -->
          <h1>The screen is currently</h1>
          <!-- Status text (updated by JS: "Awake" or "Almost sleepy") -->
          <p id="screen-status" class="highlight-text status-text mb-3">
            Awake
          </p>
          <!-- Static description -->
          <p class="info-subtext">
            This website prevents your device from going into sleep mode. Use
            the switch below to turn on/off this feature:
          </p>
          <!-- Main Keep Awake Toggle Switch -->
          <div class="form-check form-switch mx-auto py-4 d-inline-block">
            <input
              class="form-check-input py-4 px-5"
              type="checkbox"
              id="keep-awake-switch"
              checked
              aria-label="Keep awake switch"
            />
          </div>
        </div>
      </div>
    </div>
    <!-- End Hero Section -->

    <!-- Disclaimer Text -->
    <p id="info-disclaimer" class="info-disclaimer">
      This website only prevents your device from sleeping if it's in a
      <span class="highlight-text">foreground</span> tab.
      <!-- Span color changes dynamically -->
    </p>

    <!-- Modals Section -->

    <!-- About Modal -->
    <div
      class="modal fade"
      id="aboutModal"
      tabindex="-1"
      aria-labelledby="aboutModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="aboutModalLabel">About Stay Awake</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <!-- Modal Content -->
            <p>
              This project prevents your device screen from automatically
              sleeping. It includes draggable widgets for Clock, To-Do, Pomodoro
              timing, and Battery status, with position and visibility settings
              saved locally. It can also be installed as a Progressive Web App
              (PWA).
            </p>
            <p>
              This project is based on
              <a
                href="https://github.com/CarolinaMoraes/keep-awake"
                target="_blank"
                rel="noopener noreferrer"
                >keep-awake</a
              >
              by CarolinaMoraes, which itself was inspired by
              <a
                href="https://nosleep.page/"
                target="_blank"
                rel="noopener noreferrer"
                >nosleep.page</a
              >.
            </p>
            <hr />
            <p class="small text-muted">
              <strong>Troubleshooting Tip:</strong> Since all your settings,
              tasks, and widget positions are saved locally in your browser,
              simply refreshing the page is usually a safe first step if you
              encounter any display issues or bugs. Your data won't be lost on
              refresh.
            </p>
            <hr />
            <p>
              Developed by
              <a
                href="https://pranavarya.in"
                target="_blank"
                rel="noopener noreferrer"
                >Pranav Arya</a
              >.
            </p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End About Modal -->

    <!-- Name Prompt Modal (Shown on first visit) -->
    <div
      class="modal fade"
      id="namePromptModal"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="namePromptModalLabel"
      aria-hidden="true"
    >
      <!-- Static backdrop prevents closing by clicking outside -->
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="namePromptModalLabel">Welcome!</h5>
            <!-- No close button -->
          </div>
          <div class="modal-body">
            <p>Please enter your name to personalize your experience.</p>
            <!-- Name Input Field -->
            <input
              type="text"
              class="form-control"
              id="userNameInput"
              placeholder="Your Name"
              aria-label="User Name"
              required
            />
            <!-- Error message (hidden by default) -->
            <div id="nameInputError" class="text-danger mt-2 d-none">
              Please enter a name.
            </div>
          </div>
          <div class="modal-footer">
            <!-- Submit Button -->
            <button type="button" class="btn btn-primary" id="submitNameButton">
              Save Name
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End Name Prompt Modal -->

    <!-- Help/Troubleshooting Modal -->
    <div
      class="modal fade"
      id="helpModal"
      tabindex="-1"
      aria-labelledby="helpModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="helpModalLabel">
              <i class="fas fa-question-circle me-2"></i>Troubleshooting & Help
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <h6>Having Issues? Try Refreshing!</h6>
            <p>
              Sometimes visual glitches or minor bugs might occur (like a widget
              not appearing correctly after changing modes).
            </p>
            <p>
              Because all your settings (like widget visibility/position, clock
              format) and data (To-Do list items, Pomodoro state) are stored
              directly in your browser's local storage,
              <strong
                >it is safe to simply refresh the page (F5 or
                Cmd/Ctrl+R)</strong
              >.
            </p>
            <p>
              Refreshing will reload the application using your saved data,
              often resolving temporary display problems without any loss of
              information.
            </p>
            <hr />
            <h6>Found a Bug or Have Feedback?</h6>
            <p>
              If refreshing doesn't help or you've found a consistent bug,
              please report it or provide feedback on the project's GitHub
              Issues page:
            </p>
            <p class="text-center">
              <a
                href="https://github.com/PranavArya37/StayAwake/issues"
                target="_blank"
                rel="noopener noreferrer"
                class="btn btn-outline-light btn-sm"
              >
                <i class="fab fa-github me-1"></i> Report Issue on GitHub
              </a>
            </p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- End Help Modal -->

    <!-- End Modals Section -->

    <!-- Widgets Section (Positioned absolutely/fixed via CSS and JS) -->

    <!-- Digital Clock Widget -->
    <div id="digital-clock-widget" class="widget digital-clock-widget">
      <!-- Widget Header (for dragging and title) -->
      <div class="widget-header">
        <i class="fas fa-clock widget-icon"></i> Digital Clock
        <div class="widget-drag-handle"></div>
        <!-- Draggable area within header -->
      </div>
      <!-- Widget Content Area -->
      <div class="widget-content">
        <div class="digital-clock-widget-display-container">
          <!-- Date display (updated by JS) -->
          <span
            id="widget-digital-date-display"
            class="widget-date-display"
          ></span>
          <!-- Time display (updated by JS) -->
          <span
            id="widget-digital-time-display"
            class="widget-time-display"
          ></span>
        </div>
      </div>
      <!-- No resize handle for clock widget -->
    </div>
    <!-- End Digital Clock Widget -->

    <!-- Battery Status Widget -->
    <div id="battery-widget" class="widget battery-widget">
      <div class="widget-header">
        <i class="fas fa-battery-full widget-icon"></i> Battery Status
        <div class="widget-drag-handle"></div>
      </div>
      <div class="widget-content">
        <!-- Visual Battery Representation -->
        <div class="battery-visual">
          <div class="battery-capsule">
            <!-- Battery level indicator (height and color updated by JS) -->
            <div id="battery-level" class="battery-level"></div>
          </div>
        </div>
        <!-- Textual Battery Information -->
        <div class="battery-info">
          <!-- Percentage display (updated by JS) -->
          <div class="battery-percentage">
            <span id="battery-percentage-value">--</span>%
          </div>
          <!-- Charging status indicator (shown/hidden by JS) -->
          <div
            id="battery-charging-status"
            class="battery-charging-status"
            style="display: none"
          >
            Charging <i class="fas fa-bolt charging-icon"></i>
          </div>
          <!-- Low battery status indicator (shown/hidden by JS) -->
          <div
            id="battery-low-status"
            class="battery-low-status"
            style="display: none"
          >
            Low Battery <i class="fas fa-battery-quarter low-battery-icon"></i>
          </div>
        </div>
      </div>
      <!-- No resize handle for battery widget -->
    </div>
    <!-- End Battery Status Widget -->

    <!-- To-Do List Widget -->
    <div id="todo-widget" class="widget todo-widget">
      <div class="widget-header">
        <i class="fas fa-list-check widget-icon"></i> To-Do List
        <div class="widget-drag-handle"></div>
      </div>
      <div class="widget-content">
        <!-- Unordered list where tasks are rendered by JS -->
        <ul id="todo-list" class="todo-list"></ul>
      </div>
      <!-- Widget Footer (for adding new tasks) -->
      <div class="widget-footer">
        <!-- Input field for new tasks -->
        <input
          type="text"
          id="new-todo-input"
          class="form-control form-control-sm"
          placeholder="Add new task..."
        />
        <!-- Button to add the task -->
        <button
          id="add-todo-button"
          class="btn btn-sm btn-primary"
          title="Add Task"
        >
          <i class="fas fa-plus"></i>
        </button>
      </div>
      <!-- Resize Handle (bottom-right corner) -->
      <div class="widget-resize-handle"></div>
    </div>
    <!-- End To-Do List Widget -->

    <!-- Pomodoro Timer Widget -->
    <div id="pomodoro-widget" class="widget pomodoro-widget">
      <div class="widget-header">
        <i class="fas fa-stopwatch widget-icon"></i> Pomodoro Timer
        <div class="widget-drag-handle"></div>
      </div>
      <div class="widget-content p-3">
        <!-- Mode Selection Buttons -->
        <div
          class="pomodoro-modes btn-group w-100 mb-3"
          role="group"
          aria-label="Pomodoro Modes"
        >
          <!-- JS adds 'active' class to the current mode -->
          <button
            type="button"
            class="btn btn-sm btn-outline-secondary pomodoro-mode-btn active"
            data-mode="pomodoro"
          >
            Pomodoro (25m)
          </button>
          <button
            type="button"
            class="btn btn-sm btn-outline-secondary pomodoro-mode-btn"
            data-mode="shortBreak"
          >
            Short Break (5m)
          </button>
          <button
            type="button"
            class="btn btn-sm btn-outline-secondary pomodoro-mode-btn"
            data-mode="longBreak"
          >
            Long Break (15m)
          </button>
        </div>
        <!-- Time Display (updated by JS) -->
        <div
          id="pomodoro-time-display"
          class="pomodoro-time-display text-center mb-3"
        >
          25:00
          <!-- Initial display -->
        </div>
        <!-- Timer Control Buttons (visibility managed by JS) -->
        <div
          id="pomodoro-controls"
          class="pomodoro-controls d-flex justify-content-center gap-2"
        >
          <button
            id="start-pomodoro-btn"
            class="btn btn-success btn-sm"
            title="Start Timer"
          >
            <i class="fas fa-play"></i> Start
          </button>
          <button
            id="pause-pomodoro-btn"
            class="btn btn-warning btn-sm"
            title="Pause Timer"
            style="display: none"
          >
            <i class="fas fa-pause"></i> Pause
          </button>
          <button
            id="reset-pomodoro-btn"
            class="btn btn-danger btn-sm"
            title="Reset Timer"
            style="display: none"
          >
            <i class="fas fa-redo"></i> Reset
          </button>
        </div>
      </div>
      <!-- No resize handle for pomodoro widget -->
    </div>
    <!-- End Pomodoro Timer Widget -->

    <!-- End Widgets Section -->

    <!-- Scripts Section -->
    <!-- Main application logic (compiled from TypeScript) -->
    <script type="module" src="./index.js"></script>
    <!-- Bootstrap JavaScript Bundle (includes Popper) -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <!-- End Scripts Section -->
  </body>
</html>
